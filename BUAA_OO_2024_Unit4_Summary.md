# BUAA_OO_2024_Unit4_Summary

“等了好久终于等到今天，梦了好久终于把梦实现~”

## 正向建模与开发

第四单元强调正向建模与开发，也即按照“**设计程序架构->绘制UML图->编程实现**”的顺序完成代码。

因此，在本单元第一次作业中，我首先通读指导书，在把握了任务需求后开始在草稿纸上着手进行程序架构。然后绘制了一个简易的UML类图，在类图中我只体现了初步计划要写的类和一些基础属性，对于具体的方法则没有过多涉及。

因为我始终认为，**架构设计固然重要，但妄图通过一次思考就把程序规划的面面俱到显然不太可能。在有了初步架构设计后，下一步应该是着手编写代码，而不是在一些细节上死磕。**毕竟，如果不去做的话，究竟哪里有问题，是很难通过空想思考出来的。

于是我便按照绘制的简易UML类图完成代码，并在实现的过程中发现了在设计上的一些不足，返回修改架构设计。也就是说，**架构设计和代码实现是相辅相成，相互补充的**

随后第二三次作业，我也按照第一次作业的思路完成：首先梳理任务需求，随后在已经有的UML类图上进行扩展，接着按照设计编写代码实现，最后根据在编写代码中遇到的问题反过来修改UML图。

## 架构设计和UML模型

这里放出我最后一次作业的UML类图、状态图和顺序图。

![](D:\IntelliJ IDEA 2023.2.1\projects_oo\Main.png)

![](D:\IntelliJ IDEA 2023.2.1\projects_oo\StatechartDiagram1.png)

![](D:\IntelliJ IDEA 2023.2.1\projects_oo\SequenceDiagram1.png)

下面介绍我的架构设计：

+ 设置`Library`类进行指令的识别和分发
+ `AppointmentOffice`类作为预约处处理预约取书相关的操作，也负责预约书籍的送入送出。同时因为续借的操作和预约有关，我将续借操作耦合在此类中进行，避免过多不必要的参数传递
+ `CirculationDesk`类作为借还处中转借书过程中被`reject`的书籍，也负责图书漂流角中书籍的升级或者归还。
+ `QueryMachine`类作为自助查询机返回查询结果
+ `DriftCorner`类作为图书漂流角容纳被捐献的书
+ `Student`类用于管理学生的相关信息，包括学生id，其所拥有的书籍和信用分等
+ `Book`类用于管理一个书籍的相关信息，例如书籍id，其被送到预约处的时间，被借走的时间，借书周期等

其中`Book`在最开始我是没有设计的，因为当时并没有考虑到书籍的信息管理。但是后来在编写代码的时候发现需要创建一个这样的类来管理书籍信息，于是返回修改补充了UML类图。

在实际的代码实现中，我对以下几个要点深有体会：

### 在`Book`类的构造方法中狠狠体验了一把`OverLoad`重载。

其实从`Book`类的属性设置上就可以看出，在不同场景下，它会被用到的属性和方法是不一样的。实际上，`Book`类最后一共有三个构造方法，一个构造方法用于预约，管理预约书籍的学生id和送达日期；一个构造方法用于借阅，管理借阅书籍的学生id，借阅日期和周期；一个构造方法用于捐书时对书进行构造。

于是体会到了面向对象的基本特性之一：**多态**——的好处。如果没有多态，我恐怕得设置多个类表示不同类型的书籍，代码的冗余量将会显著提升。

### 到底如何管理预约处的书籍才能满足预约（前两次作业）的要求？

预约的场景有这样几个需要注意的点：（在前两次作业中）

+ 一个人可能对同一本书进行多次预约
+ 取书时要取最早为这个人送到的那本
+ 预约处要储存很多人预约的书

其中，第一条决定着预约处相同id的书可能不止一本，也就是**学生和书籍不是一对一**的关系；第二条决定了管理预约处送达的书时**需要体现先后顺序**；第三条决定了需要辨别预约处的书籍分别是为谁送去的书。

当然，`Book`类中其实已经储存了所有我们希望的信息，甚至于可以直接使用一个`ArrayList`眉毛胡子一把抓。

不过，为了防止`tle`，在`ArrayList`的基础上，我还是新增了一个双层`HashMap`用于进行查询工作，`ArrayList`只在删除书籍的时候使用。

### 不会的方法不要随便乱用

此条体现在第一次作业中我判断预约书籍是否过期。在百度上查询《LocalDate怎么求两个对象之间相隔的日期》，蹦出来很多结果都用了什么`Period`，遂复制粘贴。结果在评测机上出了大锅，经调试发现原来这个破代码只求了日的间隔而不算月，简单来说，1.1和2.2的相差时间它会算成1天。。。

后来不偷懒认真查询了`LocalDate`的自带方法，使用`getDayOfYear()`顺利解决。

## 四个单元的冒险之旅

+ Unit1：架构设计

  在Unit1中经历了oo课程自己原创的最满意的程序架构：每一个类的设计都恰到好处。但扩展性的不足也让我在第2次作业经历了oo课程唯一的一次重构。

  测试思路上学会了构造特殊数据，比如括号和符号的嵌套，前导0的添加等。甚至借此在hw2刀了几个人。

+ Unit2：多线程噩梦

  自认为即使是现在也并没有完全掌握多线程。但较为难能可贵的一点是学会了自己静下心来一点一点debug，而不是一直等待他人的帮助，毕竟只有自己是最了解自己写的代码的。

  因为一些原因在本单元的第二次作业寄掉了，但也因此吸取了教训，更加认真地对待了接下来的每一次作业。

  测试思路上学会了构造边界数据，比如一直reset电梯等极端情况。

+ Unit3：我是算法低手，但喜欢JML

  JML单元的规格和实现相分离的思路给我很大的启发，同时也push我去学了之前一直掌握不算牢固的bfs寻找最短路径算法。

  ~~可能因为不需要动脑子的原因，~~JML是我oo课程中最喜欢的一个单元。在junit的测试中，我学会了根据方法规格设置测试数据和测试策略，给我后续的互测等等有很大的帮助。

+ Unit4：没有互测

  在本单元深深体会到了正向建模开发的魅力。~~下次一定~~

  借助于正向开发的便利，我在第四单元的代码很多部分都是一遍完成，没有像之前的一些单元修修改改。同时整个代码的架构均为自己独立完成。~~颇为自豪~~

  测试上主要使用了各位大神提供的评测机。

## 课程收获

+ 自己静下心来认真debug的能力
+ 与同学交流，相互解决问题的能力
+ 书写技术性博客的能力
+ 面向对象编程的初步能力
+ 代码测试的基本能力
+ 识别书写JML规则的基本能力
+ 绘制UML图的基本能力

## 特别感谢

感谢各位回答我问题，帮我debug的助教和同学；

感谢oo课程组让我体会到了写代码是一件酣畅淋漓的乐事；

感谢看好我的老师和助教给予我信心；

感谢一路陪我走来的我最亲爱的npy；

希望下次oo课程能够再会~